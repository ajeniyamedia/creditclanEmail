<div class="row" *ngIf="record_type=='1'&&!schedule_type">
    <div class="col-md-8">
        <div style="border:1px solid #ccc;">

            <div style="border-bottom:1px solid #ccc;padding: 20px;">   
                <p style="line-height: 1.2">
                    <span class="t_cool">{{state?.current_month}}</span><br>
                    <span style="font-size: 14px">List of payments due on this date(Borrowers)</span>
                </p>
            </div>

            <div *ngIf="state?.records=='0'">
                <div style="padding-bottom: 121px">
                    <div class="text-center">
                        <a href="javascript:;" style="font-size:40px"><i  class="fa fa-meh-o"></i></a>
                        <h3 style="margin-bottom: 0px; text-align: center;">No records</h3>
                    </div>
                </div>
            </div>

            <!-- New View -->
            <div class='loan_list'>
                <div class="panel no-margin hover_toggle_desc" *ngFor="let repayment of state?.repayments; let i = index" style="">
                    <div class="panel-body">
                          <article class="media">
                              <div class="pull-left thumb" style="padding-right: 15px">
                                  <span>
                                      <img src="http://res.cloudinary.com/africacodes-concepts-limited/image/upload/v1507561173/{{repayment?.request?.FILE_NAME | imagenotfound}}?q=auto" style=" width: 50px;   height: 50px; border-radius: 50%;">
                                  </span>
                              </div>
                              <div class="pull-left" style="margin-top: 5px">
                                <h5 class="no-margin t_l4 t_cool" style="margin-bottom: 5px">{{repayment.request.LEGAL_NAME}}</h5>
                                <p class="no-margin t_lh1 t_l4" style="font-size: 13px">{{repayment?.HOW_MUCH_REMAINING}}</p> 
                              </div>                              
                              <div class="pull-right text-right hover_toggle">
                                <a href="javascript:;" (click)="openSub(repayment.request.REQUEST_ID)" class="pull-right hover_show">
                                    <span class="tools pull-right" style="padding: 5px; border: 1px solid #eaeaea; border-radius: 50px;">
                                        <i class="fa fa-chevron-down" style="padding:5px"></i>
                                    </span>
                                </a>
                              </div>                              
                          </article>        
                    </div>
                    <div class="panel-body" [ngClass]="{'active': subopen==repayment.request.REQUEST_ID&&!schedule_type, 'notactive':  subopen!=repayment.request.REQUEST_ID}" style="border-top: 1px solid #ccc">
                          <div style="margin:10px auto;width:90%">
                              <app-payschedule *ngIf="repayment?.ADDED_TO_PAYMENT_QUEUE!='1'" (userUpdated)="paymentReceived($event)" [repayment]='repayment' [index]="i" [repayment_schedule_id]="repayment?.REPAYMENT_SCHEDULE_ID" [schedule_type]="schedule_type" [record_type]="record_type"></app-payschedule>
                              <div *ngIf="repayment?.ADDED_TO_PAYMENT_QUEUE=='1'">
                                  <div style="padding-bottom: 121px">
                                      <div class="text-center">
                                          <a href="javascript:;" style="font-size:40px"><i class="fa fa-meh-o"></i></a>
                                          <h3 style="margin-bottom: 0px; text-align: center;">Queued for payment</h3>
                                      </div>
                                  </div>
                              </div>
                          </div>
                    </div> 
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="panel-body text-center crd_theme_o" style="background: #618cae;color:#fff !important">
            <h4 style="margin:0px !important">Borrowers</h4>
            <img src="assets/img/bell.png" style="width:80px; margin:30px 0px 15px;">
            <div class="text-center">
              <p class="txt t_l2 t_lh1">{{state?.total|money}}</p>
              <p class="txt">{{state?.current_month}}</p>
              <p>Due</p>
            </div>                    
        </div>
        <div class="row">
            <div class="col-md-6">
                <a class="btn btn-white btn-block" *ngIf="state?.prev" (click)="showNext(state?.stop)" style="padding:12px 24px;border-radius:0px">Prev</a>
            </div>
            <div class="col-md-6">
                <a class="btn btn-white btn-block" *ngIf="state?.next" (click)="showNext(state?.start)" style="padding:12px 24px;border-radius:0px">Next</a>
            </div>
        </div>
    </div>
</div>
<div class="row" *ngIf="record_type=='2'&&!schedule_type">
    <div class="col-md-8">
        <div style="border:1px solid #ccc;">
            <div style="border-bottom:1px solid #ccc;padding: 10px 0px 20px 20px;">
                <p style="line-height: 1.2">
                    <span class="t_cool">{{state?.current_month}}</span><br>
                    <span style="font-size: 14px">List of overdue payments due on this date(Borrowers)</span>
                </p>
            </div>
            <div *ngIf="state?.records=='0'">
                <div style="padding-bottom: 121px; padding-top: 100px">
                    <div class="text-center">
                        <a href="javascript:;" style="font-size:40px"><i  class="fa fa-meh-o"></i></a>
                        <h3 style="margin-bottom: 0px; text-align: center; margin-top: 0px">No records</h3>
                    </div>
                </div>
            </div>
            <div *ngFor="let repayment of state?.repayments">
                <article class="media hover_show" style="border-bottom:1px solid #ccc;margin: 5px 0px;background: #fff;padding: 10px 0px 20px 20px;;cursor:pointer; margin-bottom:0px">
                    <div class="pull-left thumb p-thumb">
                        <img src="assets/attachments/{{repayment.request.CUSTOMER_TYPE | imagenotfound}}" style=" width: 50px;   height: 50px; border-radius: 50%; margin:10px 0px; ">
                    </div>
                    <div class="pull-right" style="margin-right:20px">
                        <div class="price">{{repayment.HOW_MUCH_REMAINING}}</div>
                        <div class="price_b"><a (click)="openSub(repayment.request.REQUEST_ID)"><i class="fa fa-chevron-down"></i></a></div>
                    </div>
                    <div class="media-body">
                        <h4 style="margin:0px; margin-top:10px">{{repayment.request.LEGAL_NAME}}</h4>
                        <p>{{repayment.request.REQUEST_PRINCIPAL}}</p>
                    </div>
                </article>
                <div [ngClass]="{'active': subopen==repayment.request.REQUEST_ID&&!schedule_type, 'notactive':  subopen!=repayment.request.REQUEST_ID}">
                    <div style="margin:40px auto;width:90%">
                        <app-payschedule *ngIf="repayment?.ADDED_TO_PAYMENT_QUEUE!='1'" (userUpdated)="paymentReceived($event)" [repayment]='repayment' [index]="i" [repayment_schedule_id]="repayment?.REPAYMENT_SCHEDULE_ID" [schedule_type]="schedule_type" [record_type]="record_type"></app-payschedule>
                        <div *ngIf="repayment?.ADDED_TO_PAYMENT_QUEUE=='1'">
                            <div style="padding-bottom: 121px">
                                <div class="text-center">
                                    <a href="javascript:;" style="font-size:40px"><i class="fa fa-meh-o"></i></a>
                                    <h3 style="margin-bottom: 0px; text-align: center;">Queued for payment</h3>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <section class="panel" style="background: #618cae;color:#fff !important;margin-bottom:10px">
            <div class="panel-body text-center">
                <h4 style="margin:0px !important">Borrowers</h4>
                <img src="assets/img/bell.png" style="width:60px;margin:15px 0px">
                <h2>{{state?.total}}</h2>
                <p>{{state?.current_month}}</p>
                <p>Due</p>
            </div>
        </section>
        <div class="row">
            <div class="col-md-6">
                <a class="btn btn-white btn-block" *ngIf="state?.prev" (click)="showNext(state?.stop)" style="padding:12px 24px;border-radius:0px">Prev</a>
            </div>
            <div class="col-md-6">
                <a class="btn btn-white btn-block" *ngIf="state?.next" (click)="showNext(state?.start)" style="padding:12px 24px;border-radius:0px">Next</a>
            </div>
        </div>
    </div>
</div>
<div class="row" *ngIf="record_type=='1'&&schedule_type">
    <div class="col-md-8">
        <div style="border:1px solid #ccc;">
            <div style="border-bottom:1px solid #ccc;padding: 10px 0px 20px 20px;">
                <h3 style="margin-bottom: 0px;">{{state?.current_month}}</h3>
                <p>List of payments due on this date(Investors)</p>
            </div>
            <div *ngIf="state?.records=='0'">
                <div style="padding-bottom: 121px">
                    <div class="text-center">
                        <a href="javascript:;" style="font-size:40px"><i  class="fa fa-meh-o"></i></a>
                        <h3 style="margin-bottom: 0px; text-align: center;">No records</h3>
                    </div>
                </div>
            </div>
            <div *ngFor="let repayment of state?.repayments">
                <article class="media" style="border-bottom:1px solid #ccc;margin: 5px 0px;background: #fff;padding: 10px 0px 20px 20px;;cursor:pointer; margin-bottom:0px">
                    <div class="pull-left thumb p-thumb">
                        <img src="http://res.cloudinary.com/africacodes-concepts-limited/image/upload/v1507561173/{{repayment?.request?.investor?.FILE_NAME | imagenotfound}}?q=auto" style=" width: 50px;   height: 50px; border-radius: 50%; margin:10px 0px; ">
                    </div>
                    <div class="pull-right" style="margin-right:20px">
                        <div class="price">{{repayment.TOTAL_COLLECTION}}</div>
                        <div class="price_b"><a (click)="openSub(repayment.request.REQUEST_ID)"><i class="fa fa-chevron-down"></i></a></div>
                    </div>
                    <div class="media-body">
                        <h4 style="margin:0px; margin-top:10px">{{repayment.request.investor.LEGAL_NAME}}</h4>
                        <p>{{repayment.request.HOW_MUCH_FOR_ACCOUNTING}}</p>
                    </div>
                </article>
                <div [ngClass]="{'active': subopen==repayment.request.REQUEST_ID&&!schedule_type, 'notactive':  subopen!=repayment.request.REQUEST_ID}">
                    <div *ngIf="repayment?.REQUEST_FOR_COLLECTION_POSTED=='1'">
                        <div style="padding-bottom: 121px">
                            <div class="text-center">
                                <a href="javascript:;" style="font-size:40px"><i class="fa fa-meh-o"></i></a>
                                <h3 style="margin-bottom: 0px; text-align: center;">Queued for payment</h3>
                            </div>
                        </div>
                    </div>
                    <div *ngIf="repayment?.REQUEST_FOR_COLLECTION_POSTED!='1'" style="margin:40px auto;width:60%">
                        <div style="border-bottom: 1px solid #d9d9d9;margin-bottom: 10px;">
                            <div class="form-group">
                                <span class="pull-left text-primary">Amount Due</span>
                                <span class="pull-right">
                      {{repayment?.TOTAL_COLLECTION}}
                   </span>
                                <div class="clearfix"></div>
                            </div>
                        </div>
                        <div style="border-bottom: 1px solid #d9d9d9;margin-bottom: 10px;">
                            <div class="form-group">
                                <span class="pull-left text-primary">Total Payment Till Date</span>
                                <span class="pull-right">
                      {{repayment?.request.payments.total}}
                   </span>
                                <div class="clearfix"></div>
                            </div>
                        </div>
                        <div style="border-bottom: 1px solid #d9d9d9;margin-bottom: 10px;">
                            <div class="form-group">
                                <span class="pull-left text-primary">Wallet Balance</span>
                                <span class="pull-right">
                      {{repayment?.request.investor.WALLET_BALANCE}}
                   </span>
                                <div class="clearfix"></div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6"></div>
                            <div class="col-md-6">
                                <button [disabled]="loading" class="btn btn-white btn-block" (click)="makeInvPayment(repayment?.INVESTMENT_SCHEDULE_ID,i)" style="padding:12px;border-radius:0px">Queue Payment</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <section class="panel" style="background: #569840;color:#fff !important;margin-bottom:10px">
            <div class="panel-body text-center">
                <h4 style="margin:0px !important">Investors</h4>
                <img src="assets/img/bell.png" style="width:60px;margin:15px 0px">
                <h2>{{state?.total}}</h2>
                <p>{{state?.current_month}}</p>
                <p>Due</p>
            </div>
        </section>
        <div class="row">
            <div class="col-md-6">
                <a class="btn btn-white btn-block" *ngIf="state?.prev" (click)="showNext(state?.stop)" style="padding:12px 24px;border-radius:0px">Prev</a>
            </div>
            <div class="col-md-6">
                <a class="btn btn-white btn-block" *ngIf="state?.next" (click)="showNext(state?.start)" style="padding:12px 24px;border-radius:0px">Next</a>
            </div>
        </div>
    </div>
</div>
<div class="row" *ngIf="record_type=='2'&&schedule_type">
    <div class="col-md-8">
        <div style="border:1px solid #ccc;">
            <div style="border-bottom:1px solid #ccc;padding: 10px 0px 20px 20px;">
                <h3 style="margin-bottom: 0px;">{{state?.current_month}}</h3>
                <p>List of overdue payments due on this date(Investors)</p>
            </div>
            <div *ngIf="state?.records=='0'">
                <div style="padding-bottom: 121px">
                    <div class="text-center">
                        <a href="javascript:;" style="font-size:40px"><i  class="fa fa-meh-o"></i></a>
                        <h3 style="margin-bottom: 0px; text-align: center;">No records</h3>
                    </div>
                </div>
            </div>
            <div *ngFor="let repayment of state?.repayments">
                <article class="media hover_show" style="border-bottom:1px solid #ccc;margin: 5px 0px;background: #fff;padding: 10px 0px 20px 20px;;cursor:pointer; margin-bottom:0px">
                    <div class="pull-left thumb p-thumb">
                        <img src="http://res.cloudinary.com/africacodes-concepts-limited/image/upload/v1507561173/{{repayment?.request.investor?.FILE_NAME | imagenotfound}}?q=auto" style=" width: 50px;   height: 50px; border-radius: 50%; margin:10px 0px; ">
                    </div>
                    <div class="pull-right" style="margin-right:20px">
                        <div class="price">{{repayment.TOTAL_COLLECTION}}</div>
                        <div class="price_b"><a (click)="openSub(repayment.request.REQUEST_ID)"><i class="fa fa-chevron-down"></i></a></div>
                    </div>
                    <div class="media-body">
                        <h4 style="margin:0px; margin-top:10px">{{repayment.request.investor.LEGAL_NAME}}</h4>
                        <p>{{repayment.request.HOW_MUCH_FOR_ACCOUNTING}}</p>
                    </div>
                </article>
                <div [ngClass]="{'active': subopen==repayment.request.REQUEST_ID&&!schedule_type, 'notactive':  subopen!=repayment.request.REQUEST_ID}">
                    <div style="margin:40px auto;width:60%">
                        <div style="border-bottom: 1px solid #d9d9d9;margin-bottom: 10px;">
                            <div class="form-group">
                                <span class="pull-left text-primary">Amount Due</span>
                                <span class="pull-right">
                        {{repayment?.TOTAL_COLLECTION}}
                     </span>
                                <div class="clearfix"></div>
                            </div>
                        </div>
                        <div style="border-bottom: 1px solid #d9d9d9;margin-bottom: 10px;">
                            <div class="form-group">
                                <span class="pull-left text-primary">Total Payment Till Date</span>
                                <span class="pull-right">
                        {{repayment?.request.payments.total}}
                     </span>
                                <div class="clearfix"></div>
                            </div>
                        </div>
                        <div style="border-bottom: 1px solid #d9d9d9;margin-bottom: 10px;">
                            <div class="form-group">
                                <span class="pull-left text-primary">Wallet Balance</span>
                                <span class="pull-right">
                        {{repayment?.request.investor.WALLET_BALANCE}}
                     </span>
                                <div class="clearfix"></div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6"></div>
                            <div class="col-md-6">
                                <button [disabled]="loading" class="btn btn-white btn-block" (click)="makeInvPayment(repayment?.INVESTMENT_SCHEDULE_ID,i)" style="padding:12px;border-radius:0px">Queue Payment</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <section class="panel" style="background: #569840;color:#fff !important;margin-bottom:10px">
            <div class="panel-body text-center">
                <h4 style="margin:0px !important">Investors</h4>
                <img src="assets/img/bell.png" style="width:60px;margin:15px 0px">
                <h2>{{state?.total|money}}</h2>
                <p>{{state?.current_month}}</p>
                <p>Due</p>
            </div>
        </section>
        <div class="row">
            <div class="col-md-6">
                <a class="btn btn-white btn-block" *ngIf="state?.prev" (click)="showNext(state?.stop)" style="padding:12px 24px;border-radius:0px">Prev</a>
            </div>
            <div class="col-md-6">
                <a class="btn btn-white btn-block" *ngIf="state?.next" (click)="showNext(state?.start)" style="padding:12px 24px;border-radius:0px">Next</a>
            </div>
        </div>
    </div>
</div>
