<section id="main-content">
    <div class="container" style="min-height:600px;">
        <div class="row" style="margin-top:120px;">
            <div class="col-md-12" style="padding:0;">
                <div id="ajax_view">
                    <div class="row">
                        <div class="col-md-8">
                            <section class="panel" style="margin-bottom:5px">
                                <div class="panel-body">
                                    <article class="media pull-left">
                                        <div class="pull-left" style="margin-top: 5px">
                                            <h4 class="no-margin" style="word-wrap:break-word; margin-bottom: 0px">Customer Wallet</h4>
                                            <p>{{state?.today}}</p>
                                        </div>
                                    </article>
                                    
                                </div>
                            </section>
                            <section class="panel" style="margin-bottom:5px">
                              <div class="panel-body">
                                  <div class="input-group">
                                      <input class="form-control" name="searchText" [(ngModel)]="search">
                                      <span class="input-group-btn">
                                          <button class="btn btn-white" [disabled]="searching || search==''" type="button" (click)="searchRecords()">Search !</button>
                                      </span>
                                  </div>
                              </div>
                          </section>
                            <section class="panel" style="border:1px solid #ccc;"  *ngIf="state?.count=='0'">
                                <div>
                                    <div style="padding-bottom: 121px">
                                        <div class="text-center">
                                            <a href="javascript:;" style="font-size:40px">
                                                <i class="fa fa-meh-o"></i>
                                            </a>
                                            <h3 style="margin-bottom: 0px; text-align: center;">No records</h3>
                                        </div>
                                    </div>
                                </div>
                            </section>

                                <!-- hidden -->
                                <article *ngFor="let disburse of state?.customer_wallets.result" class="media hide" style=" margin: 5px 0px;background: #fff;padding: 5px;cursor:pointer; margin-bottom:0px">

                                    <div class="pull-left thumb p-thumb">
                                        <a [routerLink]="['/customer',disburse.PEOPLE_CUSTOMERS_ID]">
                                            <img src="http://res.cloudinary.com/africacodes-concepts-limited/image/upload/v1507561173/{{disburse?.FILE_NAME | imagenotfound}}?q=auto" style="width:50px; height:50px">
                                        </a>
                                    </div>
                                    <span class="tools pull-right">
                                        <h5 class="no-margin" style="margin-bottom: 7px">Balance : {{disburse?.ledger.cu|number:'.2-2'}}</h5>
                                        <a (click)="openSec(disburse?.CUSTOMER_ACCOUNT_ID)">
                                            <span class="tools pull-right" style="
                                                padding: 5px;
                                                border: 1px solid #eaeaea;
                                                border-radius: 50px;">
                                              <i class="fa fa-chevron-down" style="padding:5px"></i>
                                            </span>
                                        </a>
                                    </span>


                                    <div class="media-body">
                                        <h5 class="no-margin" style="margin-bottom: 7px">{{disburse?.LEGAL_NAME}}</h5>
                                        <!-- <p class="no-margin t_lh1 t_l4" style="font-size: 14px">{{disburse?.ledger.contra_charts_size}} Transactions</p> -->
                                    </div>


                                    <div class="clearfix"></div>
                                    <div class="media-body" *ngIf="secOpen==disburse?.CUSTOMER_ACCOUNT_ID">
                                        <div class="panel-body">
                                            <div style="">
                                                <section class="panel">
                                                    <table class="table">
                                                        <thead>
                                                            <tr>
                                                                <th>Date</th>
                                                                <th>Debit</th>
                                                                <th>Credit</th>
                                                                <th>Description</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody *ngIf="disburse?.ledger.contra_charts_size=='0'">
                                                            <tr></tr>
                                                        </tbody>
                                                        <tbody *ngFor="let trans of disburse?.ledger.recent.contra_charts">
                                                            <tr *ngFor="let tran of trans">
                                                                <td>{{tran?.DATE_ADDED| amDateFormat:'dddd, MMMM Do YYYY'}}</td>
                                                                <td>{{tran?.DEBIT|number:'.2-2'}}</td>
                                                                <td>{{tran?.CREDIT|number:'.2-2'}}</td>
                                                                <td>{{tran?.NARRATION_CUSTOMER}}</td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </section>
                                                <div class="row">
                                                    <div class="col-md-6">
                                                        <button class="btn btn-white btn-block" (click)="fundwallet(disburse)">Fund Wallet</button>
                                                    </div>
                                                    <div class="col-md-6">
                                                        <button class="btn btn-white btn-block" (click)="view_statement(disburse?.ledger)">View Statement</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                </article>
                                

            <!-- New View -->
            <div class='loan_list'>
                <div class="panel no-margin box hover_toggle_desc" *ngFor="let disburse of state?.customer_wallets.result">
                    <div class="panel-body">
                          <article class="media">
                              <div class="pull-left thumb" style="padding-right: 20px">
                                <a [routerLink]="['/customer',disburse.PEOPLE_CUSTOMERS_ID]">
                                            <img src="http://res.cloudinary.com/africacodes-concepts-limited/image/upload/v1507561173/{{disburse?.FILE_NAME | imagenotfound}}?q=auto" style="width:50px; height:50px">
                                        </a>
                              </div>
                              <div class="pull-left" style="margin-top: 5px">
                                <h5 class="no-margin t_l4" style="margin-bottom: 5px">{{disburse?.LEGAL_NAME}}</h5>
                                <p class="no-margin t_lh1 t_l4" style="font-size: 13px">Lender &nbsp; | &nbsp; {{disburse?.ledger.contra_charts_size}} Transactions</p> 
                              </div>
                              
                              <div class="pull-right text-right hover_toggle">
                                <div class="hover_hide">
                                    <h5 class="no-margin t_cool t_l4" style="margin-bottom: 7px">{{disburse?.ledger.cu}}</h5>
                                    <p class="no-margin t_lh1 t_l4" style="font-size: 14px">Wallet Balance</p> 
                                </div>
                                <a href="javascript:;" (click)="openSec(disburse?.CUSTOMER_ACCOUNT_ID)" class="pull-right hover_show">
                                    <span class="tools pull-right" style="padding: 5px; border: 1px solid #eaeaea; border-radius: 50px;">
                                        <i class="fa fa-chevron-down" style="padding:5px"></i>
                                    </span>
                                </a>
                              </div>                              
                          </article>        
                    </div>
                    <div class="panel-body" *ngIf="secOpen==disburse?.CUSTOMER_ACCOUNT_ID" style="border-top: 1px solid #ccc">
                        <div *ngIf="disburse?.ledger.contra_charts_size=='0'">
                            <div style="margin-top: 50px"></div>
                            <div class="row">
                                <div class="col-md-7"></div>
                                <div class="col-md-5">                        
                                    <ul class="list list_border text-right">
                                        <li>
                                          <p class="txt t_l3 t_cool">No Transactions</p>
                                        </li>
                                        <li>
                                          <a class="txt_l4 t_dull">&nbsp;</a>
                                        </li>
                                        <li>
                                          <a class="txt_l4 t_dull">&nbsp;</a>
                                        </li>
                                    </ul>
                                </div>                                    
                            </div>
                        </div>
                        <div *ngIf="disburse?.ledger.contra_charts_size!='0'">
                            <div style="">
                                    <section class="panel">
                                            <table class="table">
                                                <thead>
                                                    <tr>
                                                        <th>Date</th>
                                                        <th>Debit</th>
                                                        <th>Credit</th>
                                                        <th>Description</th>
                                                    </tr>
                                                </thead>
                                                <tbody *ngIf="disburse?.ledger.contra_charts_size=='0'">
                                                    <tr></tr>
                                                </tbody>
                                                <tbody *ngFor="let trans of disburse?.ledger.recent.contra_charts">
                                                    <tr *ngFor="let tran of trans">
                                                        <td>{{tran?.DATE_ADDED| amDateFormat:'dddd, MMMM Do YYYY'}}</td>
                                                        <td>{{tran?.DEBIT|number:'.2-2'}}</td>
                                                        <td>{{tran?.CREDIT|number:'.2-2'}}</td>
                                                        <td>{{tran?.NARRATION_CUSTOMER}}</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </section>
                                
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-4">
                                <button class="btn btn-white btn-block" [disabled]="disburse?.ledger.cu <= 0" (click)="withdraw(disburse)">Withdrawal</button>
                              </div>
                              <div class="col-md-4">
                                <button class="btn btn-white btn-block" (click)="fundwallet(disburse)">Fund</button>
                              </div>
                              <div class="col-md-4">
                                <button class="btn btn-white btn-block" (click)="view_statement(disburse?.ledger)">View Statement</button>
                              </div>
                        </div>
                    </div> 
                </div>
            </div>   

                <div *ngIf="data?.complete == false" style="margin-top: 15px">
                    <a (click)="loadMoreRecords(data?.start)" class="pull-right btn btn-white wd_btn" style="border-radius: 0">Load More...</a>
                </div>

       </div>     
                            
                        






                        <div class="col-md-3">
                            <div class="panel-body text-center b_grey crd_theme">
                                <div class="text-center crd_top" style="margin-top: 0px; margin-bottom: 0px; padding-bottom: 0">
                                    <p class="hide">{{state?.label}}</p>
                                    <p class="t_lh1"><img src="assets/images/naira_blue.PNG"></p>
                                </div>
                                <div style="margin-bottom: 25px">
                                    <p class="txt t_l2 t_lh1"><strong>{{state?.DASHBOARD_BL.WALLET_BALANCES.CUSTOMERS_WALLET_BALANCE| money}}</strong></p>
                                    <p class="txt t_l4">Customer Balance</p>
                                </div>
                                <a class="btn btn-white btn-full egded-box wd_btn" style="display:inline">Back</a>
                            </div>
                            <section class="box panel">
                                <div class="panel-body">
                                    <ul class="list list_border">
                                        <li>
                                            <a class="txt_l4" [routerLink]="['/operations/wallet']">Wallet</a>
                                        </li>
                                        <li>
                                            <a class="txt_l4" [routerLink]="['/operations/chart_of_accounts']">Chart Of Accounts</a>
                                        </li>
                                        <li>
                                            <a class="txt_l4" [routerLink]="['/operations/journal']">Journal</a>
                                        </li>
                                        <li>
                                            <a class="txt_l4" [routerLink]="['/operations/banks']">Bank Accounts</a>
                                        </li>
                                    </ul>
                                </div>
                            </section>
                        </div>
                        <div class="col-md-1">&nbsp;</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<div class="overlay_ app_overlay animated" style="overflow:hidden;background: rgba(138, 138, 138, 0.95);" *ngIf="overlayOpen">
    <div class="col-md-12">
        <a class="dismiss cancel_treat_ close" role="button" (click)="overlayOpen=false">
            <i class="fa fa-times" aria-hidden="true"></i>
        </a>
    </div>
    <div class=" overpanel-content container" role="document" style="text-align:left;width:1000px;min-height:500px; padding-top:0px;padding-left:0px;padding-right:0px; overflow:hidden; border-radius: 5px;">
        <!-- <app-payment [record_type]="record_type" [schedule_type]="schedule_type" [disburse]="disburse" [security_question]="state?.security_question.QUESTION"></app-payment> -->
        <app-ledger (dateChanged)="handledateChanged($event)" [ledger]="ledger" [transactions]="transactions" [account_details]="account_details"></app-ledger>
    </div>
</div>
<div class="overlay_ app_overlay animated" style="overflow:hidden;background: rgba(138, 138, 138, 0.95);" *ngIf="overlayWithdrawal">
    <div class="col-md-12">
        <a class="dismiss cancel_treat_ close" role="button" (click)="overlayWithdrawal=false">
            <i class="fa fa-times" aria-hidden="true"></i>
        </a>
    </div>
    <div class=" overpanel-content container" role="document" style="text-align:left;width:400px; padding-top:0px;padding-left:0px;padding-right:0px; overflow:hidden; border-radius: 5px;">
        <app-wallettransfer [cu]='cu' [ttype]='1' [otpError]="otpError" [fundingQueued]="fundingQueued" [api_message]="api_message" [security_question]="security_question" [paymentConfirmed]="paymentConfirmed" [paymentHasBeenProcessed]="paymentHasBeenProcessed" [makingFinalPayment]="makingFinalPayment" [loading]="loading" [banks]="banks" (doInitiateFuning)="doInitiateFuning($event)" (doQueueFuning)="doQueueFuning($event)" [ledger]="ledger" [account_details]="account_details"></app-wallettransfer>
    </div>
</div>
