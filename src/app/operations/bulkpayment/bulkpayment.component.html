<section class="panel" style="overflow:hidden;">
  <div *ngIf="paymentHasBeenProcessed">
    <div *ngIf="paymentConfirmed">
      <div class="image_center">
        <div style="width: 120px;margin:20px auto;">
          <svg style="width: 100%;" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 100 125" enable-background="new 0 0 100 100" xml:space="preserve">
            <g>
              <circle fill="none" stroke="#1CA261" stroke-width="6" stroke-miterlimit="10" cx="50" cy="50" r="47"/>
              <polygon style="color:#1CA261" points="72,25 42,71 27,56 23,60 43,80 77,28  "/>
            </g>
          </svg>
        </div>
         
      </div>
      <div class="message_center text-center">Payment Processed</div>
      <div style="margin:10px 0px; text-align: center"><button (click)="paymentProcessDone()" class="btn btn-white">Close</button></div>
    </div>
    <div *ngIf="!paymentConfirmed">
      <div class="image_center">
         
        <div style="width: 120px;margin:20px auto;">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" x="0px" y="0px"><path d="M50,8A42,42,0,1,1,8,50,42,42,0,0,1,50,8m0-3A45,45,0,1,0,95,50,45,45,0,0,0,50,5Z"></path><path d="M47.08,46.44q-.79-4-1.18-6.42t-.51-3.54q-.11-1.15-.11-2a4.3,4.3,0,0,1,1.29-3.25,5.36,5.36,0,0,1,6.84,0,4.3,4.3,0,0,1,1.29,3.25q0,.84-.11,2T54.1,40q-.39,2.38-1.18,6.42T50.79,57.1H49.21Q47.87,50.48,47.08,46.44Zm-.34,15.88a4.6,4.6,0,0,1,7.85,3.25,4.16,4.16,0,0,1-1.35,3.17,4.82,4.82,0,0,1-6.51,0,4.16,4.16,0,0,1-1.35-3.17A4.43,4.43,0,0,1,46.75,62.31Z"></path></svg>
        </div>
      </div>
      <div class="message_center text-center">Error Processing Payment</div>
      <div style="margin:10px 0px; text-align: center"><button (click)="paymentProcessDone()" class="btn btn-white">Close</button></div> 
    </div>
  </div>
  <div *ngIf="!paymentHasBeenProcessed">
    <div style="padding:24px 20px; overflow: auto;">
      <div class="text-center borrower-info">
        <a class="pull-left" style="margin-right: 25px">
          <img src="assets/img/naira.png" style="width:50px; height:50px">
        </a>
        <div class="borrower-text pull-left" style="text-align:left">
          <p class="" style="margin-bottom: 0px">{{bulk_pay?.total | number:'.2-2'}}</p>
          <p class="" style="font-weight: bold">{{bulk_pay?.count}}</p>
        </div>
      </div>
    </div>
    <div>
      <div class="text-center">
        <p class="" style="font-weight: bold">Disbursement</p>
      </div>
      <div class="paytype-switch" style="width: 100%;position: relative;z-index: 10;background: white; overflow: auto">
        <a class="paystack-switch-confirm {{paytype=='confirm'?'active':''}}" (click)="switchpay('confirm')">Confirm Payment</a>
        <a class="paystack-switch-make {{paytype=='make'?'active':''}}" (click)="switchpay('make')">Make Payment</a>
      </div>
  
      <div >
        <div class="panel-body animated" *ngIf="paytype=='confirm'">
          <form [formGroup]="complexForm" (ngSubmit)="doPaymentConfirmForBulk(complexForm.value)">
            <h4>Transaction Details</h4>
            <p>Please confirm that the payment has been made.</p>
            <div class="form-group" [ngClass]="{'has-error':!complexForm.controls['LENDER_BANK_ACCOUNT_ID'].valid && complexForm.controls['LENDER_BANK_ACCOUNT_ID'].touched}"
              style="margin-bottom:15px">
              <label for="exampleInputEmail1">Disbursement Bank</label>
              <select class="form-control" [formControl]="complexForm.controls['LENDER_BANK_ACCOUNT_ID']" name="LENDER_BANK_ACCOUNT_ID"
                id="LENDER_BANK_ACCOUNT_ID">
                <option value="0"></option>
                <option *ngFor="let bank of banks" [ngValue]="bank">{{bank.LENDER_ACCOUNT_NAME}}|{{bank.LENDER_ACCOUNT_NUMBER}}</option>
              </select>
            </div>
            <div class="form-group" [ngClass]="{'has-error':!complexForm.controls['SECURITY_QUESTION_ANSWER'].valid && complexForm.controls['SECURITY_QUESTION_ANSWER'].touched}"
              style="margin-bottom:15px">
              <label for="exampleInputEmail1">{{security_question}}</label>
              <input [formControl]="complexForm.controls['SECURITY_QUESTION_ANSWER']" type="password" class="form-control" id="SECURITY_QUESTION_ANSWER"
                name="SECURITY_QUESTION_ANSWER">
              <div *ngIf="otpError" class="error alert alert-block alert-danger fade in" style="margin:10px 0px !important">
                Wrong answer.
              </div>
            </div>
            <div class="row">
              <div class="col-md-12">
                <button class="btn btn-block btn-white" [disabled]="!complexForm.valid" type="submit">Confirm Payment
                  <i class="fa fa-spinner fa-spin" *ngIf="loading"></i>
                </button>
              </div>
            </div>
          </form>
        </div>
        <div class="panel-body animated" *ngIf="paytype=='make'">
            <div class="row">
                <div class="col-md-12">
                  <form [formGroup]="walletPaymentForm" (ngSubmit)="confirmBorrowerHasBeenPaidForBulk(walletPaymentForm.value)">
                    <h4>Pay with Wallet</h4>
                    <h4>Wallet Balance</h4>
                    <h1>{{wallet_balance}}</h1>
                    <div *ngIf="wallet_status">
                      <div class="form-group" [ngClass]="{'has-error':!walletPaymentForm.controls['SECURITY_QUESTION_ANSWER'].valid && walletPaymentForm.controls['SECURITY_QUESTION_ANSWER'].touched}"
                        style="margin-bottom:15px">
                        <label for="exampleInputEmail1">{{security_question}}</label>
                        <input [formControl]="walletPaymentForm.controls['SECURITY_QUESTION_ANSWER']" type="password" class="form-control" id="SECURITY_QUESTION_ANSWER"
                          name="SECURITY_QUESTION_ANSWER">
                        <div *ngIf="otpError" class="error alert alert-block alert-danger fade in" style="margin:10px 0px !important">
                          {{otpmessage}}
                        </div>
                      </div>
                      <div class="form-group row">
                        <div class="col-md-6">
                          <button class="btn btn-block btn-white" [disabled]="!walletPaymentForm.valid||loading" type="submit">Confirm Payment
                            <i class="fa fa-spinner fa-spin" *ngIf="loading"></i>
                          </button>
                        </div>
                        <div class="col-md-6">
                          <button class="btn btn-block btn-white" [disabled]="loading" type="button" (click)="cancelPayment()">Cancel Payment</button>
                        </div>
                      </div>
                    </div>
                    <div *ngIf="!wallet_status">
                      <p>You don't have enough funds in your wallet.</p>
                      <div class="form-group row">
                        <div class="col-md-12">
                          <button class="btn btn-block btn-white" (click)="fundWalet()">Fund Your Wallet</button>
                        </div>
                      </div>
                    </div>
                  </form>
                </div>
              </div>
  
        </div>
      </div>
    </div>
  </div>
</section>